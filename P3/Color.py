"""Changing color with time"""
import math
import OpenGL.GL as GL


from core.base import Base
from core.utils import Utils
from core.attribute import Attribute
from core.uniform import Uniform


class Example(Base):
    """ Animate triangle changing its color """
    def initialize(self):
        print("Initializing program...")
        # Initialize program #
        vs_code = """
            in vec3 position;
            uniform vec3 translation;
            void main()
            {
                vec3 pos = position + translation;
                gl_Position = vec4(pos.x, pos.y, pos.z, 1.0);
            }
        """
        fs_code = """
            uniform vec3 baseColor;
            out vec4 fragColor;
            void main()
            {
                fragColor = vec4(baseColor.r, baseColor.g, baseColor.b, 1.0);
            }
        """
        self.program_ref = Utils.initialize_program(vs_code, fs_code)
        # render settings (optional) #
        # Specify color used when clearly
        GL.glClearColor(0.0, 0.0, 1.0, 1.0)
        # Set up vertex array object #
        vao_ref = GL.glGenVertexArrays(1)
        GL.glBindVertexArray(vao_ref)
        # Set up vertex attribute #
        position_data =  [[0.05,  0.168,  0.0], #A#
                                  [0.0,  0.168,  0.0], #B#
                                  [0.049,  0.191,  0.0], #C#

                                  [0.0,  0.168,  0.0], #B#
                                  [0.048,  0.191,  0.0], #C#
                                  [0.0,  0.188,  0.0], #D#

                                  [0.048,  0.191,  0.0], #C#
                                  [0.0,  0.188,  0.0], #D#
                                  [0.05,  0.2,  0.0], #E#

                                  [0.0,  0.188,  0.0], #D#
                                  [0.05,  0.2,  0.0], #E#
                                  [0.048,  0.219,  0.0], #F#

                                  [0.0,  0.188,  0.0], #D#
                                  [0.048,  0.219,  0.0], #F#
                                  [0.043,  0.233,  0.0], #G#

                                  [0.0,  0.188,  0.0], #D#
                                  [0.043,  0.233,  0.0], #G#
                                  [0.034,  0.249,  0.0], #H#

                                  [0.0,  0.188,  0.0], #D#
                                  [0.0,  0.212,  0.0], #I#
                                  [0.034,  0.249,  0.0], #H#

                                  [0.034,  0.249,  0.0], #H#
                                  [0.0,  0.212,  0.0], #I#
                                  [0.022,  0.269,  0.0], #J#

                                  [0.0,  0.212,  0.0], #I#
                                  [0.022,  0.269,  0.0], #J#
                                  [-0.018,  0.231,  0.0], #K#

                                  [0.022,  0.269,  0.0], #J#
                                  [-0.018,  0.231,  0.0], #K#
                                  [0.008,  0.282,  0.0], #L#

                                  [-0.018,  0.231,  0.0], #K#
                                  [0.008,  0.282,  0.0], #L#
                                  [-0.032,  0.240,  0.0], #M#

                                  [0.008,  0.282,  0.0], #L#
                                  [-0.032,  0.240,  0.0], #M#
                                  [-0.012,  0.292,  0.0], #N#
                                  
                                  [-0.032,  0.240,  0.0], #M#
                                  [-0.012,  0.292,  0.0], #N#
                                  [-0.05,  0.25,  0.0], #O#

                                  [-0.012,  0.292,  0.0], #N#
                                  [-0.05,  0.25,  0.0], #O#
                                  [-0.04,  0.298,  0.0], #P#

                                  [-0.05,  0.25,  0.0], #O#
                                  [-0.04,  0.298,  0.0], #P#
                                  [-0.076,  0.251,  0.0], #Q#

                                  [-0.04,  0.298,  0.0], #P#
                                  [-0.076,  0.251,  0.0], #Q#
                                  [-0.068,  0.299,  0.0], #R#

                                  [-0.076,  0.251,  0.0], #Q#
                                  [-0.068,  0.299,  0.0], #R#
                                  [-0.1,  0.25,  0.0], #S#
                                  
                                  [-0.068,  0.299,  0.0], #R#
                                  [-0.1,  0.25,  0.0], #S#
                                  [-0.09,  0.299,  0.0], #T#

                                  [-0.1,  0.25,  0.0], #S#
                                  [-0.09,  0.299,  0.0], #T#
                                  [-0.131,  0.247,  0.0], #U#

                                  [-0.09,  0.299,  0.0], #T#
                                  [-0.131,  0.247,  0.0], #U#
                                  [-0.128,  0.299,  0.0], #V#

                                  [-0.131,  0.247,  0.0], #U#
                                  [-0.128,  0.299,  0.0], #V#
                                  [-0.148,  0.240,  0.0], #W#

                                  [-0.128,  0.299,  0.0], #V#
                                  [-0.148,  0.240,  0.0], #W#
                                  [-0.149,  0.297,  0.0], #Z#

                                  [-0.148,  0.240,  0.0], #W#
                                  [-0.149,  0.297,  0.0], #Z#
                                  [-0.164,  0.227,  0.0], #A1#

                                  [-0.149,  0.297,  0.0], #Z#
                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.168,  0.289,  0.0], #B1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.168,  0.289,  0.0], #B1#
                                  [-0.186,  0.279,  0.0], #C1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.186,  0.279,  0.0], #C1#
                                  [-0.201,  0.268,  0.0], #D1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.201,  0.268,  0.0], #D1#
                                  [-0.213,  0.256,  0.0], #E1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.213,  0.256,  0.0], #E1#
                                  [-0.225,  0.237,  0.0], #F1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.225,  0.237,  0.0], #F1#
                                  [-0.228,  0.221,  0.0], #G1#

                                  [-0.164,  0.227,  0.0], #A1#
                                  [-0.228,  0.221,  0.0], #G1#
                                  [-0.171,  0.207,  0.0], #H1#

                                  [-0.228,  0.221,  0.0], #G1#
                                  [-0.171,  0.207,  0.0], #H1#
                                  [-0.230,  0.196,  0.0], #I1#

                                  [-0.171,  0.207,  0.0], #H1#
                                  [-0.230,  0.196,  0.0], #I1#
                                  [-0.169,  0.188,  0.0], #J1#

                                  [-0.230,  0.196,  0.0], #I1#
                                  [-0.169,  0.188,  0.0], #J1#
                                  [-0.225,  0.170,  0.0], #K1#

                                  [-0.169,  0.188,  0.0], #J1#
                                  [-0.225,  0.170,  0.0], #K1#
                                  [-0.218,  0.153,  0.0], #L1#

                                  [-0.169,  0.188,  0.0], #J1#
                                  [-0.218,  0.153,  0.0], #L1#
                                  [-0.163,  0.174,  0.0], #M1#

                                  [-0.218,  0.153,  0.0], #L1#
                                  [-0.163,  0.174,  0.0], #M1#
                                  [-0.154,  0.159,  0.0], #N1#

                                  [-0.218,  0.153,  0.0], #L1#
                                  [-0.154,  0.159,  0.0], #N1#
                                  [-0.207,  0.132,  0.0], #O1#

                                  [-0.154,  0.159,  0.0], #N1#
                                  [-0.207,  0.132,  0.0], #O1#
                                  [-0.144,  0.146,  0.0], #P1#

                                  [-0.207,  0.132,  0.0], #O1#
                                  [-0.144,  0.146,  0.0], #P1#
                                  [-0.133,  0.133,  0.0], #Q1#

                                  [-0.207,  0.132,  0.0], #O1#
                                  [-0.133,  0.133,  0.0], #Q1#
                                  [-0.197,  0.115,  0.0], #R1#

                                  [-0.133,  0.133,  0.0], #Q1#
                                  [-0.197,  0.115,  0.0], #R1#
                                  [-0.187,  0.1,  0.0], #S1#

                                  [-0.133,  0.133,  0.0], #Q1#
                                  [-0.187,  0.1,  0.0], #S1#
                                  [-0.123,  0.122,  0.0], #T1#

                                  [-0.187,  0.1,  0.0], #S1#
                                  [-0.123,  0.122,  0.0], #T1#
                                  [-0.174,  0.085,  0.0], #U1#

                                  [-0.123,  0.122,  0.0], #T1#
                                  [-0.174,  0.085,  0.0], #U1#
                                  [-0.109,  0.111,  0.0], #V1#

                                  [-0.174,  0.085,  0.0], #U1#
                                  [-0.109,  0.111,  0.0], #V1#
                                  [-0.163,  0.074,  0.0], #W1#

                                  [-0.109,  0.111,  0.0], #V1#
                                  [-0.163,  0.074,  0.0], #W1#
                                  [-0.097,  0.102,  0.0], #Z1#

                                  [-0.163,  0.074,  0.0], #W1#
                                  [-0.097,  0.102,  0.0], #Z1#
                                  [-0.149,  0.061,  0.0], #A2#

#ERRO#
                                  [-0.097,  0.102,  0.0], #Z1#
                                  [-0.149,  0.061,  0.0], #A2#
                                  [-0.132,  0.049,  0.0], #B2#

                                  [-0.149,  0.061,  0.0], #A2#
                                  [-0.133,  0.049,  0.0], #B2#
                                  [-0.084,  0.094,  0.0], #C2#

                                  [-0.133,  0.049,  0.0], #B2#
                                  [-0.084,  0.094,  0.0], #C2#
                                  [-0.119,  0.043,  0.0], #D2#

                                  [-0.084,  0.094,  0.0], #C2#
                                  [-0.119,  0.043,  0.0], #D2#
                                  [-0.066,  0.083,  0.0], #E2#

                                  [-0.119,  0.043,  0.0], #D2#
                                  [-0.066,  0.083,  0.0], #E2#
                                  [-0.099,  0.034,  0.0], #F2#

                                  [-0.066,  0.083,  0.0], #E2#
                                  [-0.099,  0.034,  0.0], #F2#
                                  [-0.05,  0.075,  0.0], #G2#

                                  [-0.099,  0.034,  0.0], #F2#
                                  [-0.05,  0.075,  0.0], #G2#
                                  [-0.084,  0.027,  0.0], #H2#

                                  [-0.05,  0.075,  0.0], #G2#
                                  [-0.084,  0.027,  0.0], #H2#
                                  [-0.031,  0.066,  0.0], #I2#

                                  [-0.084,  0.027,  0.0], #H2#
                                  [-0.031,  0.066,  0.0], #I2#
                                  [-0.066,  0.018,  0.0], #J2#

                                  [-0.031,  0.066,  0.0], #I2#
                                  [-0.066,  0.018,  0.0], #J2#
                                  [-0.016,  0.057,  0.0], #K2#

                                  [-0.066,  0.018,  0.0], #J2#
                                  [-0.016,  0.057,  0.0], #K2#
                                  [-0.051,  0.01,  0.0], #L2#

                                  [-0.016,  0.057,  0.0], #K2#
                                  [-0.051,  0.01,  0.0], #L2#
                                  [0.0,  0.05,  0.0], #M2#

                                  [-0.051,  0.01,  0.0], #L2#
                                  [0.0,  0.05,  0.0], #M2#
                                  [-0.034,  0.001,  0.0], #N2#

                                  [0.0,  0.05,  0.0], #M2#
                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.012,  0.039,  0.0], #O2#

                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.012,  0.039,  0.0], #O2#
                                  [0.022,  0.031,  0.0], #P2#

                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.022,  0.031,  0.0], #P2#
                                  [0.035,  0.019,  0.0], #Q2#

                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.035,  0.019,  0.0], #Q2#
                                  [0.045,  0.0,  0.0], #R2#

                                  #S2 e T2 final do S em baixo#

                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.045,  0.0,  0.0], #R2#
                                  [0.049,  -0.015,  0.0], #U2#

                                  [-0.034,  0.001,  0.0], #N2#
                                  [0.049,  -0.015,  0.0], #U2#
                                  [-0.02,  -0.012,  0.0], #V2#

                                  [0.049,  -0.015,  0.0], #U2#
                                  [-0.02,  -0.012,  0.0], #V2#
                                  [0.053,  -0.029,  0.0], #W2#

                                  [-0.02,  -0.012,  0.0], #V2#
                                  [0.053,  -0.029,  0.0], #W2#
                                  [-0.013,  -0.031,  0.0], #Z2#

                                  [0.053,  -0.029,  0.0], #W2#
                                  [-0.013,  -0.031,  0.0], #Z2#
                                  [0.055,  -0.048,  0.0], #A3#

                                  [-0.013,  -0.031,  0.0], #Z2#
                                  [0.055,  -0.048,  0.0], #A3#
                                  [-0.008,  -0.054,  0.0], #B3#

                                  [0.055,  -0.048,  0.0], #A3#
                                  [-0.008,  -0.054,  0.0], #B3#
                                  [0.058,  -0.065,  0.0], #C3#

                                  [-0.008,  -0.054,  0.0], #B3#
                                  [0.058,  -0.065,  0.0], #C3#
                                  [-0.006,  -0.073,  0.0], #D3#

                                  [0.058,  -0.065,  0.0], #C3#
                                  [-0.006,  -0.073,  0.0], #D3#
                                  [0.057,  -0.089,  0.0], #E3#

                                  [-0.006,  -0.073,  0.0], #D3#
                                  [0.057,  -0.089,  0.0], #E3#
                                  [-0.003,  -0.091,  0.0], #F3#

                                  [0.057,  -0.089,  0.0], #E3#
                                  [-0.003,  -0.091,  0.0], #F3#
                                  [0.055,  -0.114,  0.0], #G3#

                                  [-0.003,  -0.091,  0.0], #F3#
                                  [0.055,  -0.114,  0.0], #G3#
                                  [-0.005,  -0.116,  0.0], #H3#

                                  [0.055,  -0.114,  0.0], #G3#
                                  [-0.005,  -0.116,  0.0], #H3#
                                  [0.052,  -0.136,  0.0], #I3#

                                  [-0.005,  -0.116,  0.0], #H3#
                                  [0.052,  -0.136,  0.0], #I3#
                                  [-0.006,  -0.135,  0.0], #J3#

                                  [0.052,  -0.136,  0.0], #I3#
                                  [-0.006,  -0.135,  0.0], #J3#
                                  [0.049,  -0.158,  0.0], #K3#

                                  [-0.006,  -0.135,  0.0], #J3#
                                  [0.049,  -0.158,  0.0], #K3#
                                  [-0.01,  -0.162,  0.0], #L3#

                                  [0.049,  -0.158,  0.0], #K3#
                                  [-0.01,  -0.162,  0.0], #L3#
                                  [0.044,  -0.190,  0.0], #M3#

                                  [-0.01,  -0.162,  0.0], #L3#
                                  [0.044,  -0.190,  0.0], #M3#
                                  [-0.019,  -0.187,  0.0], #N3#

                                  [0.044,  -0.190,  0.0], #M3#
                                  [-0.019,  -0.187,  0.0], #N3#
                                  [0.029,  -0.222,  0.0], #O3#

                                  [-0.019,  -0.187,  0.0], #N3#
                                  [0.029,  -0.222,  0.0], #O3#
                                  [-0.029,  -0.207,  0.0], #P3#

                                  [0.029,  -0.222,  0.0], #O3#
                                  [-0.029,  -0.207,  0.0], #P3#
                                  [0.014,  -0.245,  0.0], #Q3#

                                  [-0.029,  -0.207,  0.0], #P3#
                                  [0.014,  -0.245,  0.0], #Q3#
                                  [-0.047,  -0.228,  0.0], #R3#

                                  [0.014,  -0.245,  0.0], #Q3#
                                  [-0.047,  -0.228,  0.0], #R3#
                                  [-0.002,  -0.262,  0.0], #S3#

                                  [-0.047,  -0.228,  0.0], #R3#
                                  [-0.002,  -0.262,  0.0], #S3#
                                  [-0.021,  -0.278,  0.0], #T3#

                                  [-0.047,  -0.228,  0.0], #R3#
                                  [-0.021,  -0.278,  0.0], #T3#
                                  [-0.065,  -0.240,  0.0], #U3#

                                  [-0.021,  -0.278,  0.0], #T3#
                                  [-0.065,  -0.240,  0.0], #U3#
                                  [-0.043,  -0.285,  0.0], #V3#

                                  [-0.065,  -0.240,  0.0], #U3#
                                  [-0.043,  -0.285,  0.0], #V3#
                                  [-0.061,  -0.291,  0.0], #W3#

                                  [-0.065,  -0.240,  0.0], #U3#
                                  [-0.061,  -0.291,  0.0], #W3#
                                  [-0.088,  -0.294,  0.0], #Z3#

                                  [-0.065,  -0.240,  0.0], #U3#
                                  [-0.088,  -0.294,  0.0], #Z3#
                                  [-0.089,  -0.242,  0.0], #A4#

                                  [-0.088,  -0.294,  0.0], #Z3#
                                  [-0.089,  -0.242,  0.0], #A4#
                                  [-0.108,  -0.294,  0.0], #B4#

                                  [-0.089,  -0.242,  0.0], #A4#
                                  [-0.108,  -0.294,  0.0], #B4#
                                  [-0.113,  -0.240,  0.0], #C4#

                                  [-0.108,  -0.294,  0.0], #B4#
                                  [-0.113,  -0.240,  0.0], #C4#
                                  [-0.129,  -0.291,  0.0], #D4#

                                  [-0.113,  -0.240,  0.0], #C4#
                                  [-0.129,  -0.291,  0.0], #D4#
                                  [-0.129,  -0.237,  0.0], #E4#

                                  [-0.129,  -0.291,  0.0], #D4#
                                  [-0.129,  -0.237,  0.0], #E4#
                                  [-0.147,  -0.287,  0.0], #F4#

                                  [-0.129,  -0.237,  0.0], #E4#
                                  [-0.147,  -0.287,  0.0], #F4#
                                  [-0.148,  -0.230,  0.0], #G4#

                                  [-0.147,  -0.287,  0.0], #F4#
                                  [-0.148,  -0.230,  0.0], #G4#
                                  [-0.171,  -0.281,  0.0], #H4#

                                  [-0.148,  -0.230,  0.0], #G4#
                                  [-0.171,  -0.281,  0.0], #H4#
                                  [-0.164,  -0.213,  0.0], #I4#

                                  [-0.171,  -0.281,  0.0], #H4#
                                  [-0.164,  -0.213,  0.0], #I4#
                                  [-0.189,  -0.272,  0.0], #J4#

                                  [-0.164,  -0.213,  0.0], #I4#
                                  [-0.189,  -0.272,  0.0], #J4#
                                  [-0.203,  -0.258,  0.0], #K4#

                                  [-0.164,  -0.213,  0.0], #I4#
                                  [-0.203,  -0.258,  0.0], #K4#
                                  [-0.216,  -0.241,  0.0], #L4#

                                  [-0.164,  -0.213,  0.0], #I4#
                                  [-0.216,  -0.241,  0.0], #L4#
                                  [-0.223,  -0.224,  0.0], #M4#

                                  [-0.164,  -0.213,  0.0], #I4#
                                  [-0.223,  -0.224,  0.0], #M4#
                                  [-0.168,  -0.198,  0.0], #N4#

                                  [-0.223,  -0.224,  0.0], #M4#
                                  [-0.168,  -0.198,  0.0], #N4#
                                  [-0.227,  -0.204,  0.0], #O4#

                                  [-0.168,  -0.198,  0.0], #N4#
                                  [-0.227,  -0.204,  0.0], #O4#
                                  [-0.170,  -0.181,  0.0], #P4#

                                  [-0.227,  -0.204,  0.0], #O4#
                                  [-0.170,  -0.181,  0.0], #P4#
                                  [-0.229,  -0.188,  0.0], #Q4#

                                  [-0.170,  -0.181,  0.0], #P4#
                                  [-0.229,  -0.188,  0.0], #Q4#
                                  [-0.170,  -0.169,  0.0], #T2#

                                  [-0.229,  -0.188,  0.0], #Q4#
                                  [-0.170,  -0.169,  0.0], #T2#
                                  [-0.230,  -0.168,  0.0], #S2#
                                  ]
        self.vertex_count = len(position_data)
        position_attribute = Attribute('vec3', position_data)
        position_attribute.associate_variable(self.program_ref, 'position')
        # Set up uniforms #
        self.translation = Uniform('vec3', [0.0, 0.0, 0.0])
        self.translation.locate_variable(self.program_ref, 'translation')
        self.base_color = Uniform('vec3', [1.0, 1.0, 1.0])
        self.base_color.locate_variable(self.program_ref, 'baseColor')

    def update(self):
        """ Update data """
        # Fast change, note 3 * self.time
        
        self.base_color.data[0] = (math.sin(self.time) + 1) / 2
        self.base_color.data[1] = (math.sin(self.time) + 1) / 2
        self.base_color.data[2] = (math.sin(self.time) + 1) / 2
        ## Render scene
        # Reset color buffer with specified color
        GL.glClear(GL.GL_COLOR_BUFFER_BIT)
        GL.glUseProgram(self.program_ref)
        self.translation.upload_data()
        self.base_color.upload_data()
        GL.glDrawArrays(GL.GL_TRIANGLES, 0, self.vertex_count)


# Instantiate this class and run the program
Example().run()